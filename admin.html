<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª - –ú–ª–∞–¥ –ñ—É—Ä–Ω–∞–ª–∏—Å—Ç</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="firebase-config.js"></script>
    <style>
        body { padding-top: 100px; }
        .admin-section { margin-bottom: 60px; }
        .admin-section h2 { border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 30px; }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1>–ú–ª–∞–¥ –ñ—É—Ä–Ω–∞–ª–∏—Å—Ç - –ê–¥–º–∏–Ω</h1>
                <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ</p>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">‚Üê –ù–∞–∑–∞–¥ –∫—ä–º —Å–∞–π—Ç–∞</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="container">
        <!-- Article Publishing Section -->
        <section class="admin-section">
            <h2>–ü—É–±–ª–∏–∫—É–≤–∞–Ω–µ –Ω–∞ —Å—Ç–∞—Ç–∏–∏</h2>
            <form id="articleForm">
                <div class="form-group">
                    <input type="text" id="title" placeholder="–ó–∞–≥–ª–∞–≤–∏–µ –Ω–∞ —Å—Ç–∞—Ç–∏—è—Ç–∞" required>
                </div>
                <div class="form-group">
                    <textarea id="excerpt" placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ (—â–µ —Å–µ –ø–æ–∫–∞–∂–µ –Ω–∞ –Ω–∞—á–∞–ª–Ω–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞)" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <textarea id="content" placeholder="–ü—ä–ª–µ–Ω —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç–∞—Ç–∏—è—Ç–∞..." rows="10" required></textarea>
                </div>
                <div class="form-group">
                    <input type="text" id="author" placeholder="–ê–≤—Ç–æ—Ä" required>
                </div>
                <div class="form-group">
                    <select id="category" required>
                        <option value="news">–ù–æ–≤–∏–Ω–∏</option>
                        <option value="interview">–ò–Ω—Ç–µ—Ä–≤—é</option>
                        <option value="opinion">–ú–Ω–µ–Ω–∏–µ</option>
                        <option value="culture">–ö—É–ª—Ç—É—Ä–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>

                 <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                <div class="form-group">
                    <label for="articleImage">URL –Ω–∞ —Å–Ω–∏–º–∫–∞ (–ø–æ –∏–∑–±–æ—Ä):</label>
                    <input type="url" id="articleImage" placeholder="https://example.com/image.jpg">
                    <small>–í—ä–≤–µ–¥–µ—Ç–µ –ª–∏–Ω–∫ –∫—ä–º —Å–Ω–∏–º–∫–∞ (–æ—Ç Google Drive, ImgBB, Unsplash –∏ –¥—Ä.)</small>
                </div>
                
                <button type="submit" class="btn">–ü—É–±–ª–∏–∫—É–≤–∞–π —Å—Ç–∞—Ç–∏—è</button>
            </form>
            <div id="articleMessage" class="form-message"></div>
        </section>

        <!-- Calendar Management Section -->
        <section class="admin-section" style="padding: 40px 0; background: #f8f9fa; margin-top: 40px; border-radius: 10px;">
            <div class="container">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–∞</h2>
                <div class="admin-container">
                    <!-- Add Event Form -->
                    <div class="admin-form-section">
                        <h3>–î–æ–±–∞–≤–∏ –Ω–æ–≤–æ —Å—ä–±–∏—Ç–∏–µ</h3>
                        <form id="eventForm">
                            <input type="text" id="eventTitle" placeholder="–ó–∞–≥–ª–∞–≤–∏–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ" required>
                            <textarea id="eventDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" rows="3"></textarea>
                            <input type="date" id="eventDate" required>
                            <input type="time" id="eventTime" required>
                            <input type="text" id="eventLocation" placeholder="–ú—è—Å—Ç–æ" required>
                            <button type="submit" class="btn">–î–æ–±–∞–≤–∏ —Å—ä–±–∏—Ç–∏–µ</button>
                        </form>
                        <div id="eventMessage" class="form-message"></div>
                    </div>

                    <!-- Events List -->
                    <div class="admin-events-section">
                        <h3>–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏ —Å—ä–±–∏—Ç–∏—è</h3>
                        <div id="adminEventsList" class="events-list">
                            <!-- Events will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 –ö–ª—É–± "–ú–ª–∞–¥ –ñ—É—Ä–Ω–∞–ª–∏—Å—Ç". –í—Å–∏—á–∫–∏ –ø—Ä–∞–≤–∞ –∑–∞–ø–∞–∑–µ–Ω–∏.</p>
        </div>
    </footer>

    <!-- Load JavaScript files -->
    <script>
        // Article form handler
        document.getElementById('articleForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '–ü—É–±–ª–∏–∫—É–≤–∞–Ω–µ...';
            submitBtn.disabled = true;
            
            const articleData = {
                title: document.getElementById('title').value,
                excerpt: document.getElementById('excerpt').value,
                content: document.getElementById('content').value,
                author: document.getElementById('author').value,
                category: document.getElementById('category').value,
                date: new Date().toISOString(),
                imageUrl: document.getElementById('articleImage').value || ''
            };

            db.ref('articles').push(articleData)
                .then(() => {
                    document.getElementById('articleMessage').innerHTML = 
                        '<div class="success-message">‚úÖ –°—Ç–∞—Ç–∏—è—Ç–∞ –µ –ø—É–±–ª–∏–∫—É–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!</div>';
                    document.getElementById('articleForm').reset();
                })
                .catch((error) => {
                    document.getElementById('articleMessage').innerHTML = 
                        '<div class="error-message">‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫—É–≤–∞–Ω–µ</div>';
                    console.error('Error:', error);
                })
                .finally(() => {
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                });
        });

        // Calendar form handler
        document.getElementById('eventForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const title = document.getElementById('eventTitle').value;
            const description = document.getElementById('eventDescription').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const location = document.getElementById('eventLocation').value;
            
            if (!title || !date || !time || !location) {
                alert('–ú–æ–ª—è, –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–∏ –ø–æ–ª–µ—Ç–∞');
                return;
            }
            
            const dateTimeString = `${date}T${time}`;
            const timestamp = new Date(dateTimeString).getTime();
            
            if (isNaN(timestamp)) {
                alert('–ù–µ–≤–∞–ª–∏–¥–Ω–∞ –¥–∞—Ç–∞ –∏–ª–∏ —á–∞—Å');
                return;
            }
            
            const eventData = {
                title: title,
                description: description,
                location: location,
                timestamp: timestamp,
                created: new Date().getTime()
            };
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '–î–æ–±–∞–≤—è–Ω–µ...';
            submitBtn.disabled = true;
            
            db.ref('events').push(eventData)
                .then(() => {
                    document.getElementById('eventMessage').innerHTML = 
                        '<div class="success-message">‚úÖ –°—ä–±–∏—Ç–∏–µ—Ç–æ –µ –¥–æ–±–∞–≤–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!</div>';
                    document.getElementById('eventForm').reset();
                    loadEvents();
                })
                .catch((error) => {
                    document.getElementById('eventMessage').innerHTML = 
                        '<div class="error-message">‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</div>';
                    console.error('Error:', error);
                })
                .finally(() => {
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                });
        });

        // Load events function
        function loadEvents() {
            db.ref('events').orderByChild('timestamp').once('value')
                .then((snapshot) => {
                    const eventsContainer = document.getElementById('adminEventsList');
                    eventsContainer.innerHTML = '';
                    
                    if (!snapshot.exists()) {
                        eventsContainer.innerHTML = '<div class="no-events">–í—Å–µ –æ—â–µ –Ω—è–º–∞ —Å—ä–±–∏—Ç–∏—è</div>';
                        return;
                    }
                    
                    const now = new Date().getTime();
                    let hasEvents = false;
                    
                    snapshot.forEach((childSnapshot) => {
                        const event = childSnapshot.val();
                        const eventId = childSnapshot.key;
                        const eventDate = new Date(event.timestamp);
                        
                        const isUpcoming = eventDate.getTime() > new Date().getTime();
                        const eventDiv = document.createElement('div');
                        eventDiv.className = `admin-event-card ${isUpcoming ? 'upcoming' : 'past'}`;
                        
                        const dateString = eventDate.toLocaleDateString('bg-BG', { 
                            weekday: 'long',
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                        
                        eventDiv.innerHTML = `
                            <button class="delete-event-btn" onclick="deleteEvent('${eventId}')">‚úï</button>
                            <div class="admin-event-date">
                                <strong>${dateString}</strong>
                            </div>
                            <h3 class="admin-event-title">${event.title}</h3>
                            ${event.description ? `<p class="admin-event-description">${event.description}</p>` : ''}
                            <p class="admin-event-location">üìç ${event.location}</p>
                        `;
                        
                        eventsContainer.appendChild(eventDiv);
                        hasEvents = true;
                    });
                    
                    if (!hasEvents) {
                        eventsContainer.innerHTML = '<div class="no-events">–í—Å–µ –æ—â–µ –Ω—è–º–∞ —Å—ä–±–∏—Ç–∏—è</div>';
                    }
                })
                .catch((error) => {
                    console.error('Error loading events:', error);
                    document.getElementById('adminEventsList').innerHTML = 
                        '<div class="no-events">–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ —Å—ä–±–∏—Ç–∏—è—Ç–∞</div>';
                });
        }

        function deleteEvent(eventId) {
            if (confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–≤–∞ —Å—ä–±–∏—Ç–∏–µ?')) {
                db.ref('events/' + eventId).remove()
                    .then(() => {
                        document.getElementById('eventMessage').innerHTML = 
                            '<div class="success-message">‚úÖ –°—ä–±–∏—Ç–∏–µ—Ç–æ –µ –∏–∑—Ç—Ä–∏—Ç–æ —É—Å–ø–µ—à–Ω–æ!</div>';
                        loadEvents();
                    })
                    .catch((error) => {
                        console.error('Error deleting event:', error);
                        document.getElementById('eventMessage').innerHTML = 
                            '<div class="error-message">‚ùå –ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑—Ç—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Å—ä–±–∏—Ç–∏–µ—Ç–æ</div>';
                    });
            }
        }

        // Load events when page loads
        document.addEventListener('DOMContentLoaded', loadEvents);
    </script>
</body>

</html>
